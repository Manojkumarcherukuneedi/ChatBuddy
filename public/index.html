<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChatBuddy</title>

<style>
/* =========================================
   GLOBAL BACKGROUND
========================================= */
body {
  margin: 0;
  padding: 0;
  font-family: "Poppins", sans-serif;
  background: linear-gradient(135deg, #26D0CE, #1A2980);
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: 0.3s;
}

body.dark {
  background: linear-gradient(135deg, #0f0f0f, #232323);
  color: white;
}

/* =========================================
   SIDEBAR MENU
========================================= */
.menu-btn {
  position: absolute;
  top: 25px;
  left: 25px;
  font-size: 30px;
  color: white;
  cursor: pointer;
  z-index: 999;
}

.side-menu {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  background: linear-gradient(135deg, #26D0CE, #1A2980);
  color: white;
  box-shadow: 4px 0px 12px rgba(0,0,0,0.35);
  transition: 0.3s ease;
  padding-top: 60px;
  z-index: 1000;
}

.close-btn {
  position: absolute;
  top: 18px;
  right: 15px;
  font-size: 28px;
  cursor: pointer;
}

.menu-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.menu-list li {
  padding: 20px;
  font-size: 18px;
  cursor: pointer;
  border-bottom: 1px solid rgba(255,255,255,0.25);
}

.menu-list li:hover {
  background: rgba(255,255,255,0.15);
}

.logout-item {
  color: #ff4b4b;
  font-weight: bold;
}

.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.45);
  display: none;
  z-index: 900;
}

/* =========================================
   ACCOUNT BUTTON
========================================= */

#account-btn {
  position: absolute;
  top: 25px;
  right: 25px;
  cursor: pointer;
  z-index: 999;
}

#account-btn img {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 2px solid white;
}

/* ACCOUNT DROPDOWN */
#account-dropdown {
  position: absolute;
  top: 80px;
  right: 25px;
  width: 230px;
  background: rgba(255,255,255,0.95);
  border-radius: 12px;
  padding: 15px;
  display: none;
  box-shadow: 0px 5px 15px rgba(0,0,0,0.25);
  z-index: 999;
}

#account-dropdown.show {
  display: block;
}

#account-dropdown p {
  margin: 5px 0;
  font-size: 15px;
  color: #222;
}

/* =========================================
   CHAT UI
========================================= */
.chat-container {
  width: 420px;
  background: rgba(255,255,255,0.18);
  backdrop-filter: blur(10px);
  padding: 30px;
  border-radius: 18px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.25);
  text-align: center;
}

h1 {
  margin: 0;
  margin-bottom: 10px;
  font-size: 40px;
  color: white;
  cursor: pointer;
}

.toggle-dark {
  font-size: 14px;
  cursor: pointer;
  margin-bottom: 12px;
}

.chat-box {
  width: 100%;
  height: 260px;
  background: rgba(255,255,255,0.35);
  padding: 12px;
  border-radius: 12px;
  overflow-y: auto;
  margin-bottom: 15px;
}

input {
  width: 90%;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 12px;
  border: 2px solid black;
  font-size: 16px;
}

button {
  width: 90%;
  padding: 12px;
  margin-bottom: 10px;
  border: 2px solid black;
  border-radius: 12px;
  background: white;
  font-weight: bold;
  cursor: pointer;
  font-size: 17px;
}

.danger-btn {
  background: #ff4b4b !important;
  color: white;
  border: none;
}

/* Messages */
.msg-user {
  background: rgba(255,255,255,0.85);
  padding: 8px 12px;
  border-radius: 10px;
  margin-left: auto;
  max-width: 80%;
  margin-bottom: 6px;
}

.msg-bot {
  background: rgba(0,0,0,0.25);
  padding: 8px 12px;
  border-radius: 10px;
  max-width: 80%;
  margin-bottom: 6px;
  color: white;
}

/* =========================================
   PAGES (SETTINGS, PRIVACY, NOTIFICATIONS, ABOUT)
========================================= */
.page {
  position: absolute;
  top: 0;
  left: 0;
  width: 420px;
  height: 100%;
  background: linear-gradient(90deg, #1C9DBD, #6AD3F6);
  padding: 25px;
  display: none;
  overflow-y: auto;
  border-radius: 18px;
}

.page h2 {
  text-align: center;
  margin-bottom: 20px;
}
</style>

</head>

<body>

<!-- MENU BUTTON -->
<div class="menu-btn" onclick="openMenu()">â˜°</div>

<!-- ACCOUNT BUTTON -->
<div id="account-btn">
  <img src="https://cdn-icons-png.flaticon.com/512/456/456212.png" />
</div>

<!-- ACCOUNT DROPDOWN -->
<div id="account-dropdown">
  <p><strong>Username:</strong> <span id="acc-username">Loading...</span></p>
  <p><strong>Member since:</strong> <span id="acc-created">Loading...</span></p>
</div>

<!-- SIDEBAR -->
<div id="sideMenu" class="side-menu">
  <div class="close-btn" onclick="closeMenu()">âœ•</div>

  <ul class="menu-list">
    <li onclick="goHome()">Home</li>
    <li onclick="openSettings()">Settings</li>
    <li onclick="openPrivacy()">Privacy & Security</li>
    <li onclick="openNotifications()">Notifications</li>
    <li onclick="openAbout()">About</li>
    <li class="logout-item" onclick="logout()">Logout</li>
  </ul>
</div>

<!-- OVERLAY -->
<div id="overlay" class="overlay" onclick="closeMenu()"></div>


<!-- CHAT UI -->
<div class="chat-container" id="chatContainer">
  <h1 onclick="goHome()">ChatBuddy</h1>
  <div class="toggle-dark" onclick="toggleDark()">ðŸŒ™ Toggle Dark Mode</div>

  <div class="chat-box" id="chatBox"></div>

  <input id="msgInput" placeholder="Type your message..." />
  <button onclick="sendMsg()">Send</button>
  <button onclick="motivate()">Motivate me</button>
  <button onclick="loadHistory()">Load History</button>
  <button class="danger-btn" onclick="deleteHistory()">Delete History</button>
</div>


<!-- SETTINGS PAGE -->
<div id="settingsPage" class="page">
  <h2>Settings</h2>
  <button onclick="closePages()">Back</button>
</div>

<!-- PRIVACY PAGE -->
<div id="privacyPage" class="page">
  <h2>Privacy & Security</h2>
  <button onclick="closePages()">Back</button>
</div>

<!-- NOTIFICATIONS PAGE -->
<div id="notificationsPage" class="page">
  <h2>Notifications</h2>
  <button onclick="closePages()">Back</button>
</div>

<!-- ABOUT PAGE -->
<div id="aboutPage" class="page">
  <h2>About ChatBuddy</h2>
  <button onclick="closePages()">Back</button>
</div>


<!-- CHAT SCRIPT -->
<script src="/js/chat.js"></script>

<script>
/* ACCOUNT DROPDOWN */
document.getElementById("account-btn").onclick = () => {
  document.getElementById("account-dropdown").classList.toggle("show");
};

/* LOAD PROFILE INFO */
fetch("/api/profile")
  .then(res => res.json())
  .then(data => {
    document.getElementById("acc-username").textContent = data.username;
    document.getElementById("acc-created").textContent =
      new Date(data.created_at).toDateString();
  });


/* PAGE SWITCHING */
function showPage(id) {
  closeMenu();
  document.getElementById("chatContainer").style.display = "none";
  document.querySelectorAll(".page").forEach(p => p.style.display = "none");
  document.getElementById(id).style.display = "block";
}

function closePages() {
  document.getElementById("chatContainer").style.display = "block";
  document.querySelectorAll(".page").forEach(p => p.style.display = "none");
}

function openSettings() { showPage("settingsPage"); }
function openPrivacy() { showPage("privacyPage"); }
function openNotifications() { showPage("notificationsPage"); }
function openAbout() { showPage("aboutPage"); }


/* SIDEBAR CONTROLS */
function openMenu() {
  document.getElementById("sideMenu").style.left = "0px";
  document.getElementById("overlay").style.display = "block";
}

function closeMenu() {
  document.getElementById("sideMenu").style.left = "-260px";
  document.getElementById("overlay").style.display = "none";
}
</script>

</body>
</html>
